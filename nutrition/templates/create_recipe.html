{% comment %}
  web_nutrition: a web based nutrition and diet analysis program.
  Copyright (C) 2008 Edgar Denny

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as
  published by the Free Software Foundation, either version 3 of the
  License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}

{% extends "base.html" %}

{% block title %}Create Recipe{% endblock %}</title>

{% block content %}
  <h1>Search</h1>
  <form action="/create_recipe/" method="POST">
    <p>
    Name: {{ recipe.name|escape }}
    {% if recipe.name.errors %}<span class="errors">*</span>{% endif %}
    Number Servings: {{ recipe.num_servings }}
    {% if recipe.num_servings.errors %}<span class="errors">*</span>{% endif %}
    Category: {{ recipe.category }}
    {% if recipe.category.errors %}<span class="errors">*</span>{% endif %}
    </p>
    <br />
    {% if ingredient_list %}
    <table border="1">
      <tr>
        <th></th>
        <th>Number</th>
        <th>Measure</th>
        <th>Food</th>
        <th>Calories (Per Serving)</th>
      </tr>
    {% for ingredient in ingredient_list %}
      {{ ingredient.food_id }}
      {{ ingredient.name }}
      <tr>
        <td>{{ ingredient.check|escape }}
          {% if ingredient.check.errors %}<span class="errors">*</span>{% endif %}
        </td>
        <td>{{ ingredient.num_measures|escape }}
          {% if ingredient.num_measures.errors %}<span class="errors">*</span>{% endif %}
        </td>
        <td>{{ ingredient.measure|escape }}
          {% if ingredient.measure.errors %}<span class="errors">*</span>{% endif %}
        </td>
        <td><a id="odd" href="/food_search/food_id/{{ ingredient.id }}/measure/{{ ingredient.measure_str }}/amount/{{ ingredient.amount }}">{{ ingredient.name_str }}</a></td>
        <td> {{ ingredient.calories|stringformat:".2f" }}</td>
      </tr>
    {% endfor %}
    </table>
    {% endif %}
    <br />
    {% ifequal save_result 0 %}
      <p>Cannot Save: correct entries highlighted with '*'</p>
    {% endifequal %}
    <input type="submit" name="add_ingredient" value="Add Ingredient">
    <input type="submit" name="delete_ingredient" value="Delete Ingredient">
    <input type="submit" name="save_recipe" value="Save Recipe">
    <input type="submit" name="refresh" value="Refresh">
  </form>

  {% if nutrients.general %}
    <h3>Macro Nutrients</h3>
    <table border="1">
      {% for n in nutrients.general %}
         <tr>
           <td>{{ n.nutr_desc }}</td>
           <td>{{ n.nutr_value|stringformat:".2f" }} {{ n.unit_of_measure }}</td>
           <td>{{ n.percent_rdi|stringformat:".1f" }}</td>
         </tr>
      {% endfor %}
    </table>
    <h3>Vitamins</h3>
    <table border="1">
      {% for n in nutrients.vitamins %}
         <tr>
           <td>{{ n.nutr_desc }}</td>
           <td>{{ n.nutr_value|stringformat:".2f" }} {{ n.unit_of_measure }}</td>
           <td>{{ n.percent_rdi|stringformat:".1f" }}</td>
         </tr>
      {% endfor %}
    </table>
    <h3>Minerals</h3>
    <table border="1">
      {% for n in nutrients.minerals %}
         <tr>
           <td>{{ n.nutr_desc }}</td>
           <td>{{ n.nutr_value|stringformat:".2f" }} {{ n.unit_of_measure }}</td>
           <td>{{ n.percent_rdi|stringformat:".1f" }}</td>
         <tr>
      {% endfor %}
    </table>
    <h3>Amino Acids</h3>
    <table border="1">
      {% for n in nutrients.amino_acids %}
         <tr>
           <td>{{ n.nutr_desc }}</td>
           <td>{{ n.nutr_value|stringformat:".2f" }} {{ n.unit_of_measure }}</td>
           <td>{{ n.percent_rdi|stringformat:".1f" }}</td>
         </tr>
      {% endfor %}
    </table>
    <h3>Fats</h3>
    <table border="1">
      {% for n in nutrients.fats %}
         <tr>
           <td>{{ n.nutr_desc }}</td>
           <td>{{ n.nutr_value|stringformat:".2f" }} {{ n.unit_of_measure }}</td>
           <td>{{ n.percent_rdi|stringformat:".1f" }}</td>
         </tr>
      {% endfor %}
    </table>
  {% endif %}

{% endblock %}
